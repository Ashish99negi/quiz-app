<div class="quiz-page">
  <div class="bg-orb bg-orb-1"></div>
  <div class="bg-grid"></div>

  @if (currentQuestion) {
    <header class="quiz-header">
      <div class="header-left">
        <div class="topic-chip">
          <span>üìö</span>
          <span class="topic-text">{{ quizTopic }}</span>
        </div>
      </div>
      <div class="header-center">
        <span class="question-count">{{ currentQuestionIndex + 1 }} / {{ questions.length }}</span>
      </div>
      <div class="header-right">
        @if (quizMode === 'timed') {
          <div class="timer-chip" [class]="timerColor">
            <span class="timer-icon">‚è±</span>
            <span class="timer-value">{{ formatTime(timeRemaining) }}</span>
          </div>
        }
        @if (quizMode === 'survival') {
          <div class="mode-chip survival">
            <span>üíÄ</span>
            <span>Survival</span>
          </div>
        }
        @if (quizMode === 'standard') {
          <div class="mode-chip standard">
            <span>üìù</span>
            <span>Standard</span>
          </div>
        }
      </div>
    </header>

    <div class="progress-track">
      <div class="progress-fill" [style.width.%]="progressPercent"></div>
    </div>

    @if (quizMode === 'timed') {
      <div class="timer-track">
        <div
          class="timer-fill"
          [class]="timerColor"
          [style.width.%]="timerPercent"
        ></div>
      </div>
    }

    <div class="quiz-container">
      <div class="question-card">
        <div class="progress-dots">
          @for (q of questions; track q; let i = $index) {
            <div
              class="progress-dot"
              [class.answered]="q.selectedAnswer !== null"
              [class.current]="i === currentQuestionIndex"
            ></div>
          }
        </div>

        <div class="question-section">
          <p class="question-text">{{ currentQuestion.question }}</p>
        </div>

        <div class="options-list">
          @for (option of currentQuestion.options; track option; let i = $index) {
            <button
              class="option-card"
              [class.selected]="selectedOption === option"
              (click)="onOptionSelect(option)"
            >
              <span class="option-label">{{ optionLabels[i] }}</span>
              <span class="option-text">{{ option }}</span>
              <span class="option-check" [class.visible]="selectedOption === option">‚úì</span>
            </button>
          }
        </div>

        <div class="quiz-nav">
          <button
            class="nav-btn secondary"
            (click)="goToPreviousQuestion()"
            [disabled]="currentQuestionIndex === 0"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <path d="M19 12H5M12 5l-7 7 7 7"/>
            </svg>
            Previous
          </button>

          <button
            class="nav-btn primary"
            (click)="goToNextOrSubmit()"
            [disabled]="selectedOption === null"
          >
            {{ isLastQuestion ? 'Finish Quiz üèÅ' : 'Next' }}
            @if (!isLastQuestion) {
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                <path d="M5 12h14M12 5l7 7-7 7"/>
              </svg>
            }
          </button>
        </div>
      </div>
    </div>

  } @else {
    <div class="empty-state">
      <div class="empty-icon">üéØ</div>
      <h2>No Quiz Active</h2>
      <p>Please configure a quiz first.</p>
      <button class="nav-btn primary" routerLink="/configure">Go to Configuration</button>
    </div>
  }
</div>
